
<!DOCTYPE html>
<html lang="ka">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard â€” Giftart.ge</title>
    <style>
body {
  background:#faf7f4;
  font-family: Georgia, serif;
  color:#2a1f1b;
  margin:0;
  padding:0;
}

.admin-panel{
  max-width:1100px;
  margin:70px auto 100px;
  padding:20px;
}

.admin-panel h2{
  margin-bottom:25px;
  color:#6a4a3a;
  text-align:center;
  font-size:28px;
  letter-spacing:0.5px;
}

.orders-table{
  width:100%;
  border-collapse:separate;
  border-spacing:0;
  background:#fff;
  border-radius:18px;
  overflow:hidden;
  box-shadow:0 20px 40px rgba(195,138,98,0.18);
}

.orders-table th{
  background:#c38a62;
  color:#fff;
  text-align:left;
  padding:14px 14px;
  font-size:15px;
  letter-spacing:0.3px;
}

.orders-table td{
  padding:14px 12px;
  border-bottom:1px solid #efe3d9;
  vertical-align:top;
  color:#2a1f1b;
  font-size:14px;
}

.orders-table tr:last-child td{
  border-bottom:none;
}

.orders-table tbody tr:hover{
  background:#fff6ef;
  transition:.2s ease;
}

.delete-btn{
  background:#c38a62;
  color:#fff;
  border:none;
  padding:9px 14px;
  border-radius:12px;
  cursor:pointer;
  font-size:13px;
  box-shadow:0 8px 16px rgba(195,138,98,0.35);
  transition:.25s ease;
  white-space:nowrap;
  margin:4px 0;
}

.delete-btn:hover{
  background:#b57a55;
  transform:translateY(-1px);
  box-shadow:0 12px 24px rgba(195,138,98,0.45);
}

/* People info styling */
.people-info {
  background: #fff6ef;
  padding: 10px;
  border-radius: 8px;
  margin: 8px 0;
  font-size: 13px;
}

.person-item {
  padding: 6px 0;
  border-bottom: 1px dashed #e6ddd5;
}

.person-item:last-child {
  border-bottom: none;
}

.person-item strong {
  color: #6a4a3a;
}

/* Photo gallery */
.photo-gallery {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
  margin-top: 8px;
}

.photo-thumb {
  width: 60px;
  height: 60px;
  object-fit: cover;
  border-radius: 8px;
  cursor: pointer;
  border: 2px solid #e6ddd5;
  transition: .2s ease;
}

.photo-thumb:hover {
  border-color: #c38a62;
  transform: scale(1.05);
}

.image-viewer{
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.75);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 9999;
  animation: fade .25s ease;
  padding:20px;
}

@keyframes fade{
  from{opacity:0}
  to{opacity:1}
}

.image-viewer img{
  max-width: 92%;
  max-height: 88%;
  border-radius: 20px;
  box-shadow: 0 20px 40px rgba(0,0,0,.45);
  object-fit:contain;
}

.close-view{
  position: absolute;
  top: 22px;
  right: 26px;
  font-size: 30px;
  color: white;
  cursor: pointer;
  font-family: Arial;
  background: rgba(0,0,0,.5);
  width: 44px;
  height: 44px;
  border-radius: 50%;
  text-align:center;
  line-height:44px;
  transition:.2s ease;
}

.close-view:hover{
  background:#c38a62;
}

@media(max-width:900px){
  .admin-panel{
    margin:40px auto 60px;
    padding:16px;
  }
  
  .admin-panel h2{
    font-size:24px;
    margin-bottom:20px;
  }
  
  .orders-table th,
  .orders-table td{
    padding:12px 10px;
    font-size:13px;
  }
  
  .delete-btn{
    padding:8px 12px;
    font-size:12px;
  }
}

@media(max-width:720px){
  .admin-panel{
    margin:30px auto 40px;
    padding:12px;
  }
  
  .admin-panel h2{
    font-size:22px;
    margin-bottom:18px;
  }

  .orders-table,
  .orders-table thead,
  .orders-table tbody,
  .orders-table tr,
  .orders-table th{
    display:block;
  }

  .orders-table thead{
    display:none;
  }

  .orders-table tr{
    background:#fff;
    margin-bottom:14px;
    border-radius:18px;
    padding:14px;
    box-shadow:0 14px 28px rgba(0,0,0,0.08);
    border:1px solid #e6ddd5;
  }

  .orders-table td{
    border:none;
    display:flex;
    justify-content:space-between;
    align-items:flex-start;
    gap:12px;
    padding:10px 6px;
    border-bottom:1px dashed #e6ddd5;
    font-size:13px;
  }

  .orders-table td:last-child{
    border-bottom:none;
    justify-content:center;
    padding-top:14px;
  }

  .orders-table td:before{
    content:attr(data-label);
    font-weight:bold;
    color:#6a4a3a;
    min-width:80px;
    flex-shrink:0;
  }
  
  .orders-table td:last-child:before{
    display:none;
  }
  
  .delete-btn{
    width:100%;
    padding:10px;
    font-size:13px;
  }
  
  .close-view{
    top:16px;
    right:16px;
    width:40px;
    height:40px;
    line-height:40px;
    font-size:28px;
  }
  
  .image-viewer img{
    max-width:95%;
    max-height:85%;
  }
}

@media(max-width:480px){
  .admin-panel{
    margin:20px auto 30px;
    padding:10px;
  }
  
  .admin-panel h2{
    font-size:20px;
    margin-bottom:16px;
  }
  
  .orders-table tr{
    padding:12px;
    margin-bottom:12px;
    border-radius:14px;
  }
  
  .orders-table td{
    font-size:12px;
    padding:8px 4px;
    gap:8px;
  }
  
  .orders-table td:before{
    min-width:70px;
    font-size:12px;
  }
  
  .delete-btn{
    padding:9px;
    font-size:12px;
  }
}

@media(max-height:500px) and (orientation:landscape){
  .admin-panel{
    margin:20px auto;
  }
  
  .admin-panel h2{
    font-size:20px;
    margin-bottom:14px;
  }
  
  .orders-table tr{
    padding:10px;
    margin-bottom:10px;
  }
  
  .image-viewer{
    padding:10px;
  }
  
  .close-view{
    top:10px;
    right:10px;
  }
}
/* Video photos gallery - add this to your existing CSS */
.video-photos-gallery {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
  margin-top: 8px;
}

.video-photo-thumb {
  width: 80px;
  height: 80px;
  object-fit: cover;
  border-radius: 8px;
  cursor: pointer;
  border: 2px solid #e6ddd5;
  transition: .2s ease;
}

.video-photo-thumb:hover {
  border-color: #c38a62;
  transform: scale(1.05);
}
</style>
</head>
<body>
    <section class="admin-panel">
  <h2>áƒ¨áƒ”áƒ™áƒ•áƒ”áƒ—áƒ”áƒ‘áƒ˜áƒ¡ áƒ¡áƒ˜áƒ</h2>

  <table class="orders-table">
    <thead>
      <tr>
        <th>ID</th>
        <th>áƒ¨áƒ”áƒ™áƒ•áƒ”áƒ—áƒ˜áƒ¡ áƒ¢áƒ˜áƒáƒ˜</th>
        <th>áƒ“áƒ”áƒ¢áƒáƒšáƒ”áƒ‘áƒ˜</th>
        <th>áƒ›áƒ˜áƒ¡áƒáƒ›áƒáƒ áƒ—áƒ˜/áƒ’áƒáƒ’áƒ–áƒáƒ•áƒœáƒ˜áƒ¡ áƒ›áƒ”áƒ—áƒáƒ“áƒ˜</th>
        <th>áƒ’áƒáƒ“áƒáƒ®áƒ“áƒ</th>
        <th>áƒ¬áƒáƒ¨áƒšáƒ</th>
      </tr>
    </thead>

    <tbody>
     
    </tbody>
  </table>
</section>

<script>
document.addEventListener("DOMContentLoaded", ()=> {
  const tableBody = document.querySelector("tbody");

  let photoOrders = [];
  let videoOrders = [];

  try {
    photoOrders = JSON.parse(localStorage.getItem("photoOrders") || "[]");
    videoOrders = JSON.parse(localStorage.getItem("videoOrders") || "[]");
  } catch {
    photoOrders = [];
    videoOrders = [];
  }

  const allOrders = [...photoOrders, ...videoOrders]
  .sort((a, b) => b.id - a.id); 

  if(allOrders.length === 0){
    tableBody.innerHTML = `
      <tr>
        <td colspan="6" style="text-align:center;padding:30px;">
          áƒ¨áƒ”áƒ™áƒ•áƒ”áƒ—áƒ”áƒ‘áƒ˜ áƒ¯áƒ”áƒ  áƒáƒ  áƒáƒ áƒ˜áƒ¡ ğŸ™‚
        </td>
      </tr>`;
    return;
  }

  allOrders.forEach((order, index) => {
  const tr = document.createElement("tr");
  const serialNumber = allOrders.length - index; // Count backwards

    // Detect type text
    const typeText =
      order.type === "Video Story" ? "ğŸ¥ áƒ•áƒ˜áƒ“áƒ”áƒ"
      : order.type === "Greeting" ? "ğŸ‰ áƒ›áƒ˜áƒšáƒáƒªáƒ•áƒ"
      : "ğŸ“· áƒ¤áƒáƒ¢áƒ";

    // Build details column
    let detailsHtml = "";
    
    // Frame info for photo orders
    if (order.frameSize || order.frameType) {
      detailsHtml += `
        ${order.frameSize ? `áƒ–áƒáƒ›áƒ: <b>${order.frameSize}</b><br>` : ""}
        ${order.frameType ? `áƒ©áƒáƒ áƒ©áƒ: <b>${order.frameType}</b><br>` : ""}
        ${order.customFrame ? `ğŸ”¹ áƒ¤áƒ”áƒ áƒ˜: ${order.customFrame}<br>` : ""}
      `;
    }
    
    // People info for greeting orders
    if (order.type === "Greeting" && order.people && order.people.length > 0) {
      detailsHtml += `<div class="people-info">`;
      detailsHtml += `<strong>ğŸ‘¥ áƒáƒ“áƒáƒ›áƒ˜áƒáƒœáƒ”áƒ‘áƒ˜áƒ¡ áƒ áƒáƒáƒ“áƒ”áƒœáƒáƒ‘áƒ:</strong> ${order.peopleCount}<br><br>`;
      
      order.people.forEach((person, idx) => {
        detailsHtml += `
          <div class="person-item">
            <strong>${idx + 1}. ${person.name} ${person.surname}</strong> (${person.age} áƒ¬.)<br>
            <small>${person.about}</small>
          </div>
        `;
      });
      
      detailsHtml += `</div>`;
      
      // Show photos
      if (order.photos && order.photos.length > 0) {
        detailsHtml += `<br><strong>ğŸ“¸ áƒ¤áƒáƒ¢áƒáƒ”áƒ‘áƒ˜ (${order.photos.length}):</strong><br>`;
        detailsHtml += `<div class="photo-gallery">`;
        order.photos.forEach((photoUrl, idx) => {
          detailsHtml += `
            <img src="${photoUrl}" class="photo-thumb" data-view="${photoUrl}" alt="áƒ¤áƒáƒ¢áƒ ${idx + 1}">
          `;
        });
        detailsHtml += `</div>`;
      }
    }
    
    // Video photo count and display
if (order.type === "Video Story") {
  detailsHtml += `ğŸ“¸ áƒ¤áƒáƒ¢áƒáƒ”áƒ‘áƒ˜áƒ¡ áƒ áƒáƒáƒ“áƒ”áƒœáƒáƒ‘áƒ: ${order.photoCount || 0}<br>`;
  
  if (order.videoText) {
    detailsHtml += `ğŸ“ áƒ¢áƒ”áƒ¥áƒ¡áƒ¢áƒ˜: ${order.videoText}<br>`;
  }
  
  if (order.musicUrl) {
    detailsHtml += `ğŸµ áƒ›áƒ£áƒ¡áƒ˜áƒ™áƒ: <a href="${order.musicUrl}" target="_blank">YouTube áƒ‘áƒ›áƒ£áƒšáƒ˜</a><br>`;
  }
  
  // Show video photos
  if (order.photos && order.photos.length > 0) {
    detailsHtml += `<br><strong>ğŸ“· áƒ•áƒ˜áƒ“áƒ”áƒáƒ¡ áƒ¤áƒáƒ¢áƒáƒ”áƒ‘áƒ˜ (${order.photos.length}):</strong><br>`;
    detailsHtml += `<div class="video-photos-gallery">`;
    order.photos.forEach((photoUrl, idx) => {
      detailsHtml += `
        <img src="${photoUrl}" class="video-photo-thumb" data-view="${photoUrl}" alt="áƒ¤áƒáƒ¢áƒ ${idx + 1}">
      `;
    });
    detailsHtml += `</div>`;
  }
}

    tr.innerHTML = `
  <td data-label="ID:">${serialNumber}</td>

      <td data-label="áƒ¢áƒ˜áƒáƒ˜:">${typeText}</td>
      
      <td data-label="áƒ“áƒ”áƒ¢áƒáƒšáƒ”áƒ‘áƒ˜:">${detailsHtml || "â€”"}</td>

      <td data-label="áƒ›áƒ˜áƒ¡áƒáƒ›áƒáƒ áƒ—áƒ˜ / áƒ›áƒ˜áƒ¬áƒáƒ“áƒ”áƒ‘áƒ:">
        ${
          order.deliveryMethod
            ? `áƒ›áƒ˜áƒ¬áƒáƒ“áƒ”áƒ‘áƒ: <b>${order.deliveryMethod}</b><br>${order.deliveryExtra || ""}`
            : order.city
              ? `áƒ¥áƒáƒšáƒáƒ¥áƒ˜: <b>${order.city}</b><br>${order.address}<br>${order.addressNote || ""}`
              : "â€”"
        }
      </td>

      <td data-label="áƒ’áƒáƒ“áƒáƒ®áƒ“áƒ:">
        ${order.firstName || ""} ${order.lastName || ""}<br>
        â˜ ${order.phone || ""}<br>
        ${order.paymentNote ? "ğŸ“ " + order.paymentNote : ""}<br><br>

        ${
          order.receiptPhoto
            ? `<button class="delete-btn" data-view="${order.receiptPhoto}">
                áƒ¥áƒ•áƒ˜áƒ—áƒ áƒ˜áƒ¡ áƒœáƒáƒ®áƒ•áƒ
               </button>`
            : "áƒ¥áƒ•áƒ˜áƒ—áƒáƒ áƒ˜ áƒáƒ  áƒáƒ áƒ˜áƒ¡"
        }
      </td>

      <td>
        <button class="delete-btn" data-delete="${order.id}">
          áƒ¬áƒáƒ¨áƒšáƒ
        </button>
      </td>
    `;

    tableBody.appendChild(tr);
  });

  // View images (receipt or greeting photos)
  document.addEventListener("click", (e)=> {
    const view = e.target.closest("[data-view]");
    if(view){
      const src = view.dataset.view;
      const viewer = document.createElement("div");
      viewer.className = "image-viewer";

      viewer.innerHTML = `
        <div class="close-view">Ã—</div>
        <img src="${src}" alt="áƒ¡áƒ£áƒ áƒáƒ—áƒ˜">
      `;

      document.body.appendChild(viewer);

      viewer.addEventListener("click", e=>{
        if(e.target.classList.contains("close-view") || e.target === viewer){
          viewer.remove();
        }
      });
    }

    // Delete
    const del = e.target.closest("[data-delete]");
    if(del){
      const id = Number(del.dataset.delete);
      if(!confirm("áƒ“áƒáƒ áƒ¬áƒ›áƒ£áƒœáƒ”áƒ‘áƒ£áƒšáƒ˜ áƒ®áƒáƒ  áƒ áƒáƒ› áƒ¬áƒáƒ¨áƒáƒšáƒ? ğŸ˜¥")) return;

      let photos = JSON.parse(localStorage.getItem("photoOrders") || "[]");
      let videos = JSON.parse(localStorage.getItem("videoOrders") || "[]");

      photos = photos.filter(o => o.id !== id);
      videos = videos.filter(o => o.id !== id);

      localStorage.setItem("photoOrders", JSON.stringify(photos));
      localStorage.setItem("videoOrders", JSON.stringify(videos));

      location.reload();
    }
  });

});
</script>

</body>
</html>